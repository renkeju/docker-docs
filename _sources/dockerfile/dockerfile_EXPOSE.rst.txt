EXPOSE 声明端口
^^^^^^^^^^^^^^^^^^^^^^

格式为 ``EXPOSE <port_1> [<port_2>...]``

:guilabel:`EXPOSE` 指令是声明运行时容器提供服务端口，这只是一个声明，在运行时并不会因为这个声明应用就会开启这个端口的服务。在 :guilabel:`Dockerfile` 中写入这样的声明有两个好处，一个是帮助镜像使用者理解这个镜像服务的守护端口，以方便配置映射；另一个用户则是在运行时使用随机端口映射时，也就是 ``docker container run --publish-all`` 时，会自动随机映射 :guilabel:`EXPOSE` 的端口。

此外，在早期 Docker 版本中还有一个特殊的用处。以前所有的容器都运行于默认桥接网络中，因此所有容器相互之间都可以之间访问，这样存在一定的安全性问题。于是有了一个 Docker 引擎参数 ``--icc=false`` ，当指定该参数后，容器间将默认无法互相访问，除非互相之间使用了 ``--links`` 参数的容器才可以互通，并且只有镜像中 :guilabel:`EXPOSE` 所声明的端口才可以被访问。这个 ``--icc=false`` 的用法，在引入了 ``docker network`` 后已经基本不用了，通过自定义网络可以很轻松的实现容器间的互联于隔离。

要将 :guilabel:`EXPOSE` 和在运行时使用 ``--publish port_list`` 区分开来。``--publish`` 是映射宿主机端口和容器端口，换句话说，就是将容器的对应端口服务公开给外界访问，而 :guilabel:`EXPOSE` 仅仅是声明容器打算使用什么端口而已，并不会自动在宿主机进行端口映射。